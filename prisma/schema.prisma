// prisma/schema.prisma
generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = "postgresql://sinacofi:hola123@34.135.68.241:5432/rule"
}

model MessageSchema {
    id          Int          @id @default(autoincrement())
    messageCode String       @unique @db.VarChar(255)
    description String
    parameters  Parameter[]
    validations Validation[]
}

model Parameter {
    id              Int            @id @default(autoincrement())
    name            String
    label           String
    type            String
    description     String
    placeholder     String
    value           String
    defaultValue    String
    validations     Validation     @relation(fields: [validationId], references: [id])
    properties      Property[]
    MessageSchema   MessageSchema? @relation(fields: [messageSchemaId], references: [id])
    messageSchemaId Int?
    validationId    Int
}

model Validation {
    id              Int            @id @default(autoincrement())
    name            String
    required        Boolean
    maxLength       Int
    minLength       Int
    MessageSchema   MessageSchema? @relation(fields: [messageSchemaId], references: [id])
    messageSchemaId Int?
    Parameter       Parameter[]
}

model Property {
    id          Int        @id @default(autoincrement())
    name        String
    columns     Int
    rows        Int
    multiple    Boolean
    multiline   Boolean
    options     String[]
    Parameter   Parameter? @relation(fields: [parameterId], references: [id])
    parameterId Int?
}

model MessageSchemaValidation {
    schemaId     Int
    validationId Int
    assignedAt   DateTime @default(now())

    @@id([schemaId, validationId])
}

model SchemaParameter {
    schemaId    Int
    parameterId Int
    assignedAt  DateTime @default(now())

    @@id([schemaId, parameterId])
}
